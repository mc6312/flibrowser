Flibrowser - ржавый крюк для ковыряния в локальной копии flibusta.net


* ЧТО УМЕЕТ

Зохавывать индексный файл от MyHomeLib (.inpx), искать по нему книжки,
вытаскивать их из архивов библиотеки и, при необходимости, паковать
в отдельные зиповские архивы.

В данной версии заточено для работы с единственным индексным файлом,
идущим в комплекте с зеркалом либрусека+флибусты, раздаваемым на одном
кошерном трекере.

Работает под Linux (в первую очередь), под Windows _может быть_ и заработает
(когда у меня найдётся время допилить совместимость с виндовым PyGI).
Работа под чем-то еще (MacOS X, экзотические *nix'ы и т.п.) теоретически
возможна, но не проверялась, и в обозримом будущем поддержка не планируется.


* КАК ЗАПУСКАТЬ

Установки не требует (кроме правки конфига).
Запускать: python3 flibrowser.pyz


* ПОИСК КНИГ

1. В полях поиска можно (но не обязательно) использовать регулярные
   выражения. Нажатие на иконку в соответствующем поле проверяет
   правильность выражения.
2. В список найденных попадают книги, для которых совпали _все_
   непустые поля.


* ЧТО ХОЧЕТ

Из ПО:
- Python 3.3 или новее.
- Модуль sqlparse для Python 3.x
- GTK+ 3.10 или новее.
- PythonGObject/PyGI

Из файлов:
0. Файл настроек (config). Очередность поиска:
   1. Каталог настроек (если он существует):
      - под Linux: ~/.config/flibrowser/
      - под Windows: %APPDATA%\flibrowser\
   2. Каталог, где расположен flibrowse.py
   С пустым файлом настроек или без оного программа запускается,
   вываливая сразу окно настроек.
   Файлы banned* и genrelist ищутся там же, где и файл настроек.
1. Индексный файл и архивы с книжками (расположение указывается в файле
   настроек).
2. Необязательный файл с соответствиями внутрибиблиотечных тэгов и их
   человекочитаемых названий (genrelist).


* ФАЙЛ НАСТРОЕК

config - текстовый файл, по одной записи вида "параметр значение" на строку.
Строки, начинающиеся с символа "#", считаются комментариями.

Параметры:
library_root_directory <путь> - корневой каталог с загруженным зеркалом
    флибусты/либрусека и индексным файлом в формате inpx

library_index_file <путь> - имя индексного файла в формате .inpx
    если указано только имя файла без каталога, файл ищется в корневом
    каталоге библиотеки

extract_directory <путь> - каталог, куда разжимать книги
    должен быть указан абсолютный или относительный путь (в т.ч. относительно
    домашнего каталога пользователя)

data_directory <путь> - каталог с файлами нежелательных отбросов (см. далее)
    списком названий жанров и списком языков
    если не указано - файлы ищутся в том же каталоге, что и файл настроек

languages - список двухсимвольных кодов допустимых языков.
    Коды разделяются пробелами.
    Русский язык (ru) приколочен гвоздями внутри софтины навеки, ибо ваистену.


* ФАЙЛ СОСТОЯНИЯ МЕЖДУМОРДИЯ

uistate (расположение см. в п.1 раздела "Что хочет").
Хранит положение окна и состояние некоторых его элементов.
Для редактирования вручную не предназначен, создаётся и изменяется
программой автоматически.
Т.е. при необходимости (напр. при переносе программы на др. машину
или смене разрешения монитора) может быть безболезненно стёрт.


* ФОРМАТ СПИСКА ЖАНРОВ

genrelist.json - файл формата JSON, содержит словарь, где ключи - имена
тэгов, а значения - человекочитаемые названия тэгов:
{"tagname":"название тэга", ..., "othertag":"другой тэг"}
